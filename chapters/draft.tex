\ExplSyntaxOn
\ifdraft{%
	\cs_if_exist_use:cT{define@key}{{FV}{mathescape}{}}
	% Replace minted with regular environments
	\RenewDocumentCommand\mint{omv}{%
		\texttt{#3}
	}
	\RenewDocumentEnvironment{minted}{om}{%
		\VerbatimEnvironment%
		\fvset{#1}%
		\begin{Verbatim}%
	}{%
		\end{Verbatim}%
	}
	\RenewDocumentCommand\inputminted{omm}{%
		\fvset{#1}%
		\VerbatimInput{#3}%
	}
	% LaTeX source code
	\newminted{latex}{frame=single}%
	\newminted{text}{frame=single}%
	\newminted{r}{frame=single}%
	\newminted{matlab}{frame=single}%
	\newminted{gnuplot}{frame=single}%
	\newmint{latex}{frame=single}%
	% Line numbers in margin
	%\lnoson% % Disable when not spellchecking/proofreading
}{%
	% Common options
	\cs_set_nopar:Nn\l__tmpa_cs:{
		frame=single,
		bgcolor=mintedbg,
		rulecolor=\color{mintedbg}
	}
	% Define environments
	\exp_args:Nnx\newminted{latex}{\l__tmpa_cs:}
	\exp_args:Nnx\newminted{text}{\l__tmpa_cs:}
	\exp_args:Nnx\newminted{r}{\l__tmpa_cs:}
	\exp_args:Nnx\newminted{matlab}{\l__tmpa_cs:}
	\exp_args:Nnx\newminted{gnuplot}{\l__tmpa_cs:}
	\exp_args:Nnx\newmint{latex}{\l__tmpa_cs:}
	% Undefine the temporary macro
	\cs_undefine:N\l__tmpa_cs:
}
\ExplSyntaxOff
